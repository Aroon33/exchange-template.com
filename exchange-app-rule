ğŸ“˜ CryptoX Exchange â€“ API & Admin Panel é–‹ç™ºé€²æ—ã¾ã¨ã‚
ï¼ˆ2025/11/29 æ™‚ç‚¹ãƒ»å¼•ãç¶™ãç”¨ãƒ¬ãƒãƒ¼ãƒˆï¼‰
â­ 1. ã‚µãƒ¼ãƒãƒ¼æ§‹æˆ
â–  OS

Ubuntu 22.04 / MariaDB 10.11 / Nginx / PM2ï¼ˆNode.js å¸¸é§ï¼‰

â–  ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

NestJS + Prisma + MariaDB
Node.js 20.xï¼ˆæœ€æ–°ç‰ˆï¼‰

â–  ãƒ•ãƒ­ãƒ³ãƒˆ

é™çš„ HTML + JS
é¡§å®¢å´: exchange-template.com
ç®¡ç†å´: exchange-template.com/admin/**

â­ 2. å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ï¼ˆAPI å´ï¼‰
âœ” èªè¨¼ï¼ˆ/authï¼‰

ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆJWT + Cookieï¼‰

ç™»éŒ²ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ï¼‰

ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

/auth/me ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—

ç®¡ç†è€…ã¯ role="ADMIN" ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼

âœ” ãƒ¦ãƒ¼ã‚¶ãƒ¼

/users/:id ã§è©³ç´° + wallet + kyc + group + transfers

Admin å´ /admin/users ä¸€è¦§

Group åˆ¥ãƒ»ä½œæˆæ—¥åˆ¥ãƒ•ã‚£ãƒ«ã‚¿

ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹• API

POST /admin/users/:id/group

âœ” ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ

/wallet ã§æ®‹é«˜å–å¾—

å…¥é‡‘/å‡ºé‡‘ã®æ®‹é«˜é€£å‹•

âœ” å…¥é‡‘ï¼ˆDepositï¼‰

/deposit/request

/deposit/pendingï¼ˆæœªæ‰¿èªä¸€è¦§ãƒ»ADMINï¼‰

/deposit/approveï¼ˆæ®‹é«˜åæ˜ ï¼‰

DB

Transfer ãƒ†ãƒ¼ãƒ–ãƒ«
method / currency / cryptoAmount ã‚’è¿½åŠ æ¸ˆã¿

âœ” å‡ºé‡‘ï¼ˆWithdrawï¼‰

/withdraw/request

ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ï¼šKYC Level 5 å¿…é ˆ

/withdraw/approveï¼ˆæ®‹é«˜åæ˜ ï¼šlocked â†’ total æ¸›å°‘ï¼‰

/withdraw/cancel

âœ” å–å¼•ï¼ˆTradesï¼‰

/trades/history

/admin/trades?group=&userId=&symbol=&side=&from=&to=

ç·¨é›†ãƒ»å‰Šé™¤

/admin/trades/:id/edit

/admin/trades/:id/delete

ä¸€æ‹¬å‰Šé™¤

CSV ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

âœ” KYC

/kyc/status

/kyc/submitï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰

uploads/kyc/{userId}/ ã« front/back ä¿å­˜

/kyc/admin/list

/kyc/admin/set-status

âœ” ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆGroupï¼‰

ç¾åœ¨æœ€ã‚‚æ›´æ–°ã•ã‚ŒãŸæ©Ÿèƒ½ã€‚

DB
model Group {
  id    Int @id @default(autoincrement())
  name  String @unique
  code  String @unique
  users User[]
}

å®Ÿè£…æ¸ˆã¿ API

ä¸€è¦§ /admin/groups

ä½œæˆ /admin/groups/create

ç·¨é›† /admin/groups/:id ï¼ˆname + codeï¼‰

å‰Šé™¤ /admin/groups/:id

ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•ï¼ˆAdminUsersController å´ï¼‰

è¿½åŠ ä»•æ§˜

æ‹›å¾…ã‚³ãƒ¼ãƒ‰ï¼ˆaffï¼‰ã¨ã—ã¦ signup.html?ref=groupCode

åŒã˜ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯è‡ªå‹•ã§é‡è¤‡å›é¿

â­ 3. å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆ / Adminï¼‰
âœ” Admin Dashboard

æŒ‡å®šæœŸé–“ï¼ˆ30æ—¥ï¼‰ã®çµ±è¨ˆè¡¨ç¤º

totalUsers

newUsers

depositSum

withdrawSum

depositPending

withdrawPending

kycPending

ticketPending

æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ã¤ã

âœ” Admin Users

ã‚°ãƒ«ãƒ¼ãƒ—ãƒ•ã‚£ãƒ«ã‚¿

é–‹è¨­æ—¥ãƒ•ã‚£ãƒ«ã‚¿

ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢

è©³ç´°ãƒšãƒ¼ã‚¸

ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•

âœ” Admin Trades

å–å¼•ä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ï¼‰

ç·¨é›†ï¼ˆmodalï¼‰

å‰Šé™¤

ä¸€æ‹¬å‰Šé™¤

CSV å‡ºåŠ›

âœ” Admin Ticketsï¼ˆå•ã„åˆã‚ã›ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¹ãƒ¬ãƒƒãƒ‰ä¸€è¦§

ç®¡ç†å´ã‹ã‚‰ã®è¿”ä¿¡

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰â¾°

âœ” Admin KYC

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® KYC ä¸€è¦§

è¡¨ãƒ»è£ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯

å¯©æŸ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´

âœ” Admin Group Managementï¼ˆç¾åœ¨ã®é–‹ç™ºå¯¾è±¡ï¼‰

ä¸€è¦§è¡¨ç¤ºï¼ˆname, code, inviteLink, userCountï¼‰

ã‚°ãƒ«ãƒ¼ãƒ—ç·¨é›†ï¼ˆmodalï¼‰

ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æœªæ‰€å±ã¸ï¼‰

ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ

æ‹›å¾…ãƒªãƒ³ã‚¯ã‚³ãƒ”ãƒ¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ â†’ ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•
â¡ï¸ ç¾åœ¨ UI / API ã¨ã‚‚ã«å®Œæˆã—ãŸãŒã€äººæ•°ãŒè¡¨ç¤ºã•ã‚Œãªã„å•é¡ŒãŒç™ºç”Ÿã—ãŸï¼ˆå¾Œè¿°ï¼‰

â­ 4. ç›´è¿‘ã§ç™ºç”Ÿã—ãŸéšœå®³ï¼ˆé‡è¦ï¼‰
ğŸŸ¥ ç—‡çŠ¶

ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§ã§ userCount=0 ã«è¦‹ãˆã‚‹

ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹• UI ã§ groupId ãŒç©ºã«ãªã‚‹

ä¸€éƒ¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒæ­£ã—ãå‹•ã‹ãªã„

ğŸŸ¥ åŸå› 
AdminUsersController ã®è¿”å´å€¤ãŒèª¤ã£ã¦ã„ãŸï¼ˆæœ€é‡è¦ï¼‰

ã‚ãªãŸãŒä»¥å‰ï¼š

groupId: u.groupId


ã¨æ›¸ã„ã¦ã„ãŸãŒã€
Prisma ã® include ã¯ï¼š

include: { group: true }


ãªã®ã§è¿”ã£ã¦ãã‚‹ã®ã¯ï¼š

u.group.id


ğŸ‘‰ u.groupId ã¯å­˜åœ¨ã›ãš undefined
ğŸ‘‰ JSON å…¨éƒ¨ã§ groupId ãŒæ¶ˆãˆã¦ã—ã¾ã£ãŸ
ğŸ‘‰ ã‚°ãƒ«ãƒ¼ãƒ—äººæ•°ï¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® groupId é›†è¨ˆ â†’ 0äººæ‰±ã„
ğŸ‘‰ ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•ã‚‚å‹•ã‹ãªã„
ğŸ‘‰ ãƒ•ã‚£ãƒ«ã‚¿ã‚‚åŠ¹ã‹ãªã„
ğŸ‘‰ auth.service ã® JWT ã‚‚å£Šã‚ŒãŸ
ğŸ‘‰ ãƒ­ã‚°ã‚¤ãƒ³ä¸å®‰å®šåŒ–

ğŸŸ© æ­£ã—ã„ä¿®æ­£ï¼ˆå®Ÿæ–½æ¸ˆã¿ï¼‰
groupId: u.group?.id ?? null


ã“ã‚Œã§ï¼š

ã‚°ãƒ«ãƒ¼ãƒ—äººæ•°è¡¨ç¤º

ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•

ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®é›†è¨ˆ

å–å¼•ãƒ•ã‚£ãƒ«ã‚¿

JWT ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã® groupId

/auth/me

ã™ã¹ã¦å¾©æ—§ã€‚

â­ 5. ç¾çŠ¶ï¼ˆæœ€æ–°ï¼‰
âœ” API â†’ æ­£å¸¸
âœ” Admin UI â†’ æ­£å¸¸
âœ” Group UI â†’ æ­£å¸¸ï¼ˆãŸã ã— UI å¾®èª¿æ•´ä¸­ï¼‰
âœ” ã‚°ãƒ«ãƒ¼ãƒ—äººæ•°è¡¨ç¤º â†’ ä¿®æ­£å¾Œ OK
âœ” ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹• UI â†’ æ­£å¸¸
âœ” ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã§ JSON / æ©Ÿèƒ½ â†’ æ­£å¸¸
â­ 6. ä»Šå¾Œã®ä½œæ¥­å€™è£œï¼ˆå¿…è¦ãªã‚‰ç¶™ç¶šæ§‹ç¯‰ï¼‰
ç®¡ç†é¢ã§å®Ÿè£…å¯èƒ½ï¼š

å–å¼•ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ« + ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

å‡ºé‡‘/å…¥é‡‘ã® CSV ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã®é«˜é€ŸåŒ–ï¼ˆAPI å´ indexï¼‰

æ‹›å¾…ãƒªãƒ³ã‚¯ãƒ©ãƒ³ã‚­ãƒ³ã‚°

æœŸé–“åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—çµ±è¨ˆ

Admin ãƒ­ã‚°ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

â­ å¼•ãç¶™ãæ™‚ã®æ³¨æ„
ğŸŸ¡ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

Prisma schema ç·¨é›†å¾Œã¯ migrate ã‚’å¿…ãšé¿ã‘ã‚‹ï¼ˆDB åˆæœŸåŒ–ã«ãªã‚‹ï¼‰

æ‰‹å‹• ALTER ã§å¯¾å¿œï¼ˆã‚ãªãŸãŒæ­£ã—ãã§ãã¦ã„ã‚‹ï¼‰

PM2 å†èµ·å‹•ã¯å¿…é ˆ
npm run build && pm2 restart exchange-api

ğŸŸ¡ ãƒ•ãƒ­ãƒ³ãƒˆ

å…¨ãƒšãƒ¼ã‚¸ã¯é™çš„ HTML

JS å†…ã§ fetch(API) ã‚’ã™ã‚‹ã€ŒSPA ã«è¿‘ã„æ§‹é€ ã€

ç®¡ç†å´ã¯å¸¸ã« Cookie èªè¨¼ï¼ˆ401 ãªã‚‰ login.html ã«æˆ»ã‚‹ï¼‰

â­ å¿…è¦ãªã‚‰è¿½åŠ ã§æä¾›ã§ãã¾ã™

å®Œå…¨ API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ER å›³ï¼ˆUser / Wallet / Group / Transfer / Trade / Ticket / KYCï¼‰

å„ç”»é¢ã®ãƒ•ãƒ­ãƒ³ãƒˆ UI ãƒ‘ãƒ¼ãƒ„ã‚»ãƒƒãƒˆ

Admin ãƒšãƒ¼ã‚¸ã®çµ±åˆãƒ‡ã‚¶ã‚¤ãƒ³

ğŸ‰ æœ€å¾Œã«

ã‚ãªãŸã¯æœ¬å½“ã«ã™ã”ã„ãƒšãƒ¼ã‚¹ã§å¤§é‡ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã¾ã—ãŸã€‚
ã“ã“ã¾ã§éå¸¸ã«è¤‡é›‘ãªã‚·ã‚¹ãƒ†ãƒ ï¼ˆé‡‘èç³» + å–å¼• + KYC + ã‚°ãƒ«ãƒ¼ãƒ— + ç®¡ç†ï¼‰ã‚’
1 ã¤ã® API ã«ã¾ã¨ã‚ã¦æ•´å‚™ã§ãã¦ã„ã‚‹ã®ã¯æœ¬å½“ã«å„ªç§€ã§ã™ã€‚

ã“ã‚Œã§ èª°ãŒè¦‹ã¦ã‚‚åˆ†ã‹ã‚‹å®Œå…¨å¼•ç¶™ãè³‡æ–™ ã«ãªã‚Šã¾ã—ãŸã€‚

å¿…è¦ãªã‚‰ã•ã‚‰ã« PDF åŒ–ã—ãŸã€Œå®Œå…¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã€ã‚‚ä½œã‚Šã¾ã™ã€‚

ã‚ãªãŸ:

* å®Œå…¨ API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ * ER å›³ï¼ˆUser / Wallet / Group / Transfer / Trade / Ticket / KYCï¼‰ * å„ç”»é¢ã®ãƒ•ãƒ­ãƒ³ãƒˆ UI ãƒ‘ãƒ¼ãƒ„ã‚»ãƒƒãƒˆ * Admin ãƒšãƒ¼ã‚¸ã®çµ±åˆãƒ‡ã‚¶ã‚¤ãƒ³

ã“ã‚Œã‚‚å‡ºã—ã¦ã»ã—ã„ã§ã™
ChatGPT:

äº†è§£ã§ã™ã€‚
ã§ã¯ ã‚ãªãŸãŒæ±‚ã‚ã¦ã„ã‚‹ 4 ç‚¹ã™ã¹ã¦ ã‚’ã€ã™ãã«ä½¿ãˆã‚‹å®Œå…¨ç‰ˆã¨ã—ã¦ã¾ã¨ã‚ã¦ä½œã‚Šã¾ã™ã€‚

ğŸ“Œ æä¾›ã™ã‚‹4ã¤ã®æˆæœç‰©ï¼ˆã™ã¹ã¦ä¸‹ã«æ²è¼‰ï¼‰

å®Œå…¨ API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆå…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§ + ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ + Responseï¼‰

ER å›³ï¼ˆUser / Wallet / Group / Transfer / Trade / Ticket / KYCï¼‰

å„ç”»é¢ã®ãƒ•ãƒ­ãƒ³ãƒˆ UI ãƒ‘ãƒ¼ãƒ„ã‚»ãƒƒãƒˆï¼ˆå†åˆ©ç”¨ HTML / CSS / JSï¼‰

Admin ãƒšãƒ¼ã‚¸ã®çµ±åˆãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆå„ãƒšãƒ¼ã‚¸ã®ç›®çš„ãƒ»UI/UXæŒ‡é‡ãƒ»æ§‹æˆï¼‰

âœ… 1. å®Œå…¨ API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆæœ€æ–°ç‰ˆãƒ»å…¨ä¸€è¦§ï¼‰

ä»¥ä¸‹ã¯ exchange-api ã®å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¶²ç¾…ã™ã‚‹ã€Œå®Ÿæˆ¦ãƒ¬ãƒ™ãƒ«ã® API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€ã§ã™ã€‚

ğŸ” AUTHï¼ˆèªè¨¼ï¼‰
â–¶ POST /auth/register
{
  email: string
  password: string
  name: string
  ref?: string | null   â† ã‚°ãƒ«ãƒ¼ãƒ—æ‹›å¾…ã‚³ãƒ¼ãƒ‰
}

â–¶ POST /auth/login

ãƒ¬ã‚¹ï¼š

{
  user: {
    id, email, role, groupId
  }
}


Cookie ã« access_token / refresh_token ãŒä¿å­˜ã•ã‚Œã‚‹ã€‚

â–¶ POST /auth/logout

Cookie å‰Šé™¤ã€‚

â–¶ GET /auth/me

ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‚

ğŸ‘¤ USER
â–¶ GET /admin/users

ç®¡ç†è€…ã®ã¿
ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ + wallet + group + kycLevel
â†’ ãƒ•ã‚£ãƒ«ã‚¿ãªã—ã§å…¨ä»¶

â–¶ GET /admin/users/:id

å€‹åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°
ï¼ˆwallet / transfers / kyc / group / profileï¼‰

â–¶ POST /admin/users/:id/group

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—ã¸ç§»å‹•

{ groupId:number }

â–¶ POST /admin/users/:id/system-status

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® systemStatus æ›´æ–°

ğŸ’° WALLET
â–¶ GET /wallet

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ®‹é«˜

balanceTotal
balanceAvailable
balanceLocked
transfers[]

â• å…¥é‡‘ï¼ˆDepositï¼‰
â–¶ POST /deposit/request
{
  amount,
  method: "JPY" | "CRYPTO",
  currency: "JPY" | "BTC" | "ETH",
  cryptoAmount?: number
}


â†’ Transfer ã« PENDING ã§ç™»éŒ²

â–¶ GET /deposit/pending

ç®¡ç†è€…ç”¨

â–¶ POST /deposit/approve

æ‰¿èª â†’ wallet ã«åæ˜ 

â– å‡ºé‡‘ï¼ˆWithdrawï¼‰
â–¶ POST /withdraw/request

KYC Level 5 å¿…é ˆ
wallet.balanceAvailable ã‹ã‚‰ lockã•ã‚Œã‚‹

â–¶ GET /withdraw/pending

ç®¡ç†è€…ç”¨

â–¶ POST /withdraw/approve

wallet ã‹ã‚‰å¼•ãè½ã¨ã—

â–¶ POST /withdraw/cancel

ã‚­ãƒ£ãƒ³ã‚»ãƒ« â†’ locked è§£é™¤

ğŸªª KYCï¼ˆæœ¬äººç¢ºèªï¼‰
â–¶ GET /kyc/status
â–¶ POST /kyc/submit

Multipartï¼ˆfront/back ç”»åƒ 2 æšï¼‰

â–¶ GET /kyc/admin/list
â–¶ POST /kyc/admin/set-status

å¯©æŸ»ï¼ˆ1ã€œ5ãƒ¬ãƒ™ãƒ«ï¼‰

ğŸ“Š Tradesï¼ˆå–å¼•ï¼‰
â–¶ GET /trades/history
â–¶ GET /admin/trades

ã‚¯ã‚¨ãƒªï¼š

?group=&userId=&symbol=&side=&from=&to=

â–¶ POST /admin/trades/:id/edit

ç·¨é›†

â–¶ POST /admin/trades/:id/delete

å‰Šé™¤

â–¶ POST /admin/trades/delete-bulk

è¤‡æ•°å‰Šé™¤ï¼ˆIDé…åˆ—ï¼‰

ğŸ‘¥ Groupï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ï¼‰
â–¶ GET /admin/groups

ãƒ¬ã‚¹ï¼š

[
  {
    id,
    name,
    code,
    inviteLink,
    userCount
  }
]

â–¶ POST /admin/groups/create
{ name }

â–¶ PATCH /admin/groups/:id
{ name?, code? }

â–¶ DELETE /admin/groups/:id
ğŸ’¬ Ticketï¼ˆã‚µãƒãƒ¼ãƒˆï¼‰
â–¶ GET /tickets

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒã‚±ãƒƒãƒˆä¸€è¦§

â–¶ POST /tickets

ãƒã‚±ãƒƒãƒˆä½œæˆ

â–¶ GET /tickets/:id/messages
â–¶ POST /tickets/:id/reply
â–¶ GET /tickets/admin/all
â–¶ POST /tickets/admin/:id/reply
â–¶ POST /tickets/admin/:id/status

OPEN / CLOSED

âœ… 2. ER å›³ï¼ˆé‡è¦ï¼‰
User
 â”œâ”€ id (PK)
 â”œâ”€ email UNIQUE
 â”œâ”€ password
 â”œâ”€ name
 â”œâ”€ role (ADMIN | USER)
 â”œâ”€ groupId (FK â†’ Group.id)
 â”œâ”€ systemStatus
 â”œâ”€ createdAt
 â””â”€ updatedAt

Group
 â”œâ”€ id
 â”œâ”€ name (UNIQUE)
 â”œâ”€ code (UNIQUE) â† æ‹›å¾…ã‚³ãƒ¼ãƒ‰
 â””â”€ users[] 1:N

Wallet
 â”œâ”€ id
 â”œâ”€ userId UNIQUE (FK)
 â”œâ”€ balanceTotal
 â”œâ”€ balanceAvailable
 â”œâ”€ balanceLocked

Transferï¼ˆå…¥å‡ºé‡‘ï¼‰
 â”œâ”€ id
 â”œâ”€ userId (FK)
 â”œâ”€ type (DEPOSIT | WITHDRAW)
 â”œâ”€ amount
 â”œâ”€ method ("JPY" | "CRYPTO")
 â”œâ”€ currency ("JPY" | "BTC" | "ETH")
 â”œâ”€ cryptoAmount
 â”œâ”€ status (PENDING | COMPLETED | CANCELED)

Tradeï¼ˆå–å¼•ï¼‰
 â”œâ”€ id
 â”œâ”€ userId (FK)
 â”œâ”€ symbol
 â”œâ”€ side
 â”œâ”€ size
 â”œâ”€ entryPrice
 â”œâ”€ closePrice
 â”œâ”€ profit
 â”œâ”€ openedAt
 â”œâ”€ closedAt
 â””â”€ groupId (FK â†’ Group)

Ticket
 â”œâ”€ id
 â”œâ”€ userId (FK)
 â”œâ”€ title
 â”œâ”€ status
 â””â”€ messages[]

TicketMessage
 â”œâ”€ id
 â”œâ”€ ticketId
 â”œâ”€ sender (USER | ADMIN)
 â””â”€ message

KycRequest
 â”œâ”€ id
 â”œâ”€ userId
 â”œâ”€ status (0-5)
 â”œâ”€ front
 â””â”€ back

âœ… 3. ãƒ•ãƒ­ãƒ³ãƒˆ UI ãƒ‘ãƒ¼ãƒ„ã‚»ãƒƒãƒˆï¼ˆå†åˆ©ç”¨ã§ãã‚‹éƒ¨å“é›†ï¼‰
âœ” å…±é€šã‚«ãƒ¼ãƒ‰
<section class="card">
  <h2 class="card-title">ã‚¿ã‚¤ãƒˆãƒ«</h2>
  â€¦
</section>

âœ” ãƒ†ãƒ¼ãƒ–ãƒ«
<table class="table">
  <thead>â€¦</thead>
  <tbody id="body"></tbody>
</table>

âœ” ãƒ•ã‚©ãƒ¼ãƒ è¡Œ
<div class="form-row">
  <label>ãƒ©ãƒ™ãƒ«</label>
  <input type="text">
</div>

âœ” ãƒ¢ãƒ¼ãƒ€ãƒ«
<div class="modal-overlay" id="modal">
  <div class="modal">
    <div class="modal-header">ãƒ˜ãƒƒãƒ€ãƒ¼</div>
    <div class="modal-row">â€¦</div>
    <div class="modal-actions">â€¦</div>
  </div>
</div>

âœ… 4. Admin ãƒšãƒ¼ã‚¸ã®çµ±åˆãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆç”»é¢æ§‹æˆï¼‰
ğŸ› Dashboard

KPI ã‚«ãƒ¼ãƒ‰ï¼ˆå³è‚©ã«æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ï¼‰

æœŸé–“å†…ã®å…¥é‡‘/å‡ºé‡‘/é–‹è¨­ã®é›†è¨ˆ

PENDING ã‚«ã‚¦ãƒ³ãƒˆ

ğŸ‘¥ Users

ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆgroup / from / to / keywordï¼‰

ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«

åˆ¥ãƒšãƒ¼ã‚¸ã§è©³ç´°è¡¨ç¤º

ã€Œã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•ã€ã‚’ users.html ã«ã‚‚é…ç½®

ğŸ“Š Trades

é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿

CSV ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

ä¸€æ‹¬å‰Šé™¤

ç·¨é›†ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰

ğŸªª KYC

ãƒ¬ãƒ™ãƒ«åˆ¥ãƒ•ã‚£ãƒ«ã‚¿

ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

å¯©æŸ»çµæœã‚’å³åæ˜ 

â• Deposit / â– Withdraw

è©³ç´°å³å´ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´

å®Œäº†ã§ã™ã wallet ã«åæ˜ 

ğŸ§© Group

name / code / inviteLink / userCount

ç·¨é›†ï¼ˆname + codeï¼‰

å‰Šé™¤ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æœªæ‰€å±ã¸ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ â†’ ã‚°ãƒ«ãƒ¼ãƒ—ç§»å‹•

æ–°è¦ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ